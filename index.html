<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pro Esports</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;600;700&family=Outfit:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #6366f1; --secondary: #ec4899; --bg: #0f172a; --card: #1e293b; }
        body { font-family: 'Outfit', sans-serif; background: var(--bg); color: white; -webkit-tap-highlight-color: transparent; }
        .font-gaming { font-family: 'Rajdhani', sans-serif; }
        .glass { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.05); }
        .loader { border: 3px solid #333; border-top: 3px solid var(--primary); border-radius: 50%; width: 20px; height: 20px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .hide-scroll::-webkit-scrollbar { display: none; }
        .tab-active { color: var(--primary); border-top: 2px solid var(--primary); }
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="h-screen flex flex-col overflow-hidden">

    <!-- AUTH SCREEN -->
    <div id="auth-screen" class="fixed inset-0 z-50 bg-[#0f172a] flex flex-col justify-center px-6 hidden">
        <div class="text-center mb-10">
            <h1 class="text-5xl font-gaming font-bold bg-clip-text text-transparent bg-gradient-to-r from-indigo-500 to-pink-500">BATTLE<br>ARENA</h1>
            <p class="text-gray-400 tracking-widest mt-2">PLAY â€¢ COMPETE â€¢ WIN</p>
        </div>

        <div class="space-y-4">
            <button onclick="googleLogin()" class="w-full bg-white text-black py-3.5 rounded-xl font-bold flex items-center justify-center gap-3 shadow-[0_0_15px_rgba(255,255,255,0.3)]">
                <img src="https://www.svgrepo.com/show/475656/google-color.svg" class="w-6"> Login with Google
            </button>
            
            <div class="relative flex py-2 items-center">
                <div class="flex-grow border-t border-gray-700"></div>
                <span class="flex-shrink mx-4 text-gray-500 text-xs">OR EMAIL</span>
                <div class="flex-grow border-t border-gray-700"></div>
            </div>

            <input type="email" id="email" placeholder="Email" class="w-full bg-slate-800 p-4 rounded-xl border border-slate-700 focus:border-indigo-500 outline-none text-white">
            <input type="password" id="password" placeholder="Password" class="w-full bg-slate-800 p-4 rounded-xl border border-slate-700 focus:border-indigo-500 outline-none text-white">
            
            <div class="flex gap-2">
                <button onclick="emailAuth('login')" class="flex-1 bg-indigo-600 py-3 rounded-xl font-bold">Login</button>
                <button onclick="emailAuth('register')" class="flex-1 bg-slate-700 py-3 rounded-xl font-bold">Register</button>
            </div>
            <p id="auth-msg" class="text-center text-red-400 text-sm h-5"></p>
        </div>
    </div>

    <!-- MAIN APP -->
    <div id="app-screen" class="flex-1 flex flex-col hidden">
        
        <!-- Header -->
        <header class="h-16 flex justify-between items-center px-4 glass z-40">
            <div class="flex items-center gap-3">
                <img id="u-pic" src="" class="w-10 h-10 rounded-full border-2 border-indigo-500 bg-slate-800">
                <div>
                    <h3 id="u-name" class="font-bold text-sm leading-none">Player</h3>
                    <div class="flex items-center gap-1 text-xs text-yellow-400 mt-1">
                        <i class="fas fa-coins"></i> <span id="u-coins">0</span>
                    </div>
                </div>
            </div>
            <button onclick="nav('wallet')" class="bg-gradient-to-r from-indigo-600 to-pink-600 px-4 py-1.5 rounded-full text-xs font-bold shadow-lg">
                + ADD
            </button>
        </header>

        <!-- Content Pages -->
        <main class="flex-1 overflow-y-auto hide-scroll pb-20 relative bg-[#0f172a]">
            
            <!-- HOME PAGE -->
            <div id="page-home" class="p-4 space-y-6 fade-in">
                <!-- Banner Slider -->
                <div class="relative w-full h-44 rounded-2xl overflow-hidden shadow-2xl bg-slate-800 group">
                    <img id="banner-img" src="" class="w-full h-full object-cover transition-transform duration-500" onclick="bannerClick()">
                    <div class="absolute bottom-2 right-2 bg-black/50 px-2 py-1 rounded text-[10px] text-white backdrop-blur">Featured</div>
                </div>

                <!-- Categories -->
                <div>
                    <h2 class="font-gaming text-lg font-bold mb-3 border-l-4 border-indigo-500 pl-2">GAME MODES</h2>
                    <div id="cat-list" class="flex gap-4 overflow-x-auto hide-scroll pb-2">
                        <!-- Loaded via JS -->
                        <div class="w-20 h-20 bg-slate-800 rounded-full animate-pulse"></div>
                    </div>
                </div>

                <!-- Tournaments List -->
                <div>
                    <div class="flex justify-between items-end mb-3">
                        <h2 class="font-gaming text-lg font-bold border-l-4 border-pink-500 pl-2" id="selected-cat-title">All Matches</h2>
                        <div class="flex bg-slate-800 rounded-lg p-1">
                            <button onclick="filterMatch('upcoming')" id="tab-upcoming" class="px-3 py-1 text-xs font-bold bg-slate-600 rounded text-white">Upcoming</button>
                            <button onclick="filterMatch('ongoing')" id="tab-ongoing" class="px-3 py-1 text-xs font-bold text-gray-400">Live</button>
                            <button onclick="filterMatch('ended')" id="tab-ended" class="px-3 py-1 text-xs font-bold text-gray-400">Results</button>
                        </div>
                    </div>
                    <div id="t-list" class="space-y-4">
                        <!-- Matches Loaded Here -->
                    </div>
                </div>
            </div>

            <!-- WALLET PAGE -->
            <div id="page-wallet" class="p-4 space-y-6 hidden fade-in">
                <h2 class="text-2xl font-gaming font-bold text-center">MY WALLET</h2>
                
                <div class="bg-gradient-to-br from-indigo-900 to-slate-900 p-6 rounded-2xl border border-indigo-500/30 text-center relative overflow-hidden">
                    <div class="absolute top-0 right-0 w-20 h-20 bg-indigo-500 blur-[50px] opacity-40"></div>
                    <p class="text-gray-400 text-xs uppercase tracking-widest">Total Balance</p>
                    <h1 class="text-5xl font-gaming font-bold text-white mt-2">â‚¹<span id="w-bal">0</span></h1>
                </div>

                <!-- Add Money -->
                <div class="bg-slate-800/50 p-5 rounded-2xl border border-slate-700">
                    <h3 class="font-bold text-lg mb-4 flex items-center gap-2"><i class="fas fa-robot text-pink-500"></i> AI Deposit</h3>
                    
                    <div class="grid grid-cols-3 gap-3 mb-4">
                        <button onclick="setAmt(20)" class="bg-slate-700 py-2 rounded-lg text-sm hover:bg-indigo-600 transition">â‚¹20</button>
                        <button onclick="setAmt(50)" class="bg-slate-700 py-2 rounded-lg text-sm hover:bg-indigo-600 transition">â‚¹50</button>
                        <button onclick="setAmt(100)" class="bg-slate-700 py-2 rounded-lg text-sm hover:bg-indigo-600 transition">â‚¹100</button>
                    </div>

                    <div id="qr-area" class="text-center hidden">
                        <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=upi://pay?pa=dipesh@upi&pn=TournamentApp" class="mx-auto rounded-lg border-4 border-white mb-2 w-32">
                        <p class="text-xs text-gray-400 mb-3">Pay exactly: <span id="pay-amt" class="text-white font-bold"></span></p>
                        
                        <label class="block w-full bg-slate-700 p-3 rounded-xl text-xs text-center text-gray-300 mb-3 cursor-pointer">
                            <i class="fas fa-upload mr-1"></i> Upload Payment Screenshot
                            <input type="file" id="ss-input" accept="image/*" class="hidden">
                        </label>
                        
                        <button onclick="verifyAI()" id="verify-btn" class="w-full bg-green-600 py-3 rounded-xl font-bold shadow-lg shadow-green-500/20">VERIFY PAYMENT</button>
                        <p id="ai-status" class="text-xs mt-2 text-yellow-400 min-h-[20px]"></p>
                    </div>
                </div>

                <!-- Withdraw -->
                <div class="bg-slate-800/50 p-5 rounded-2xl border border-slate-700">
                    <h3 class="font-bold text-lg mb-4 text-red-400">Withdraw</h3>
                    <input type="text" id="w-upi" placeholder="Enter UPI ID" class="w-full bg-slate-900 p-3 rounded-lg text-sm mb-3 border border-slate-700 outline-none">
                    <input type="number" id="w-amount" placeholder="Amount (Min â‚¹40)" class="w-full bg-slate-900 p-3 rounded-lg text-sm mb-3 border border-slate-700 outline-none">
                    <button onclick="reqWithdraw()" class="w-full bg-red-600/80 py-3 rounded-xl font-bold">Request Withdraw</button>
                </div>
            </div>

            <!-- PROFILE PAGE -->
            <div id="page-profile" class="p-4 hidden fade-in">
                <h2 class="text-2xl font-gaming font-bold mb-4">My Matches</h2>
                <div id="my-matches" class="space-y-3 pb-10"></div>
                
                <button onclick="firebase.auth().signOut()" class="w-full mt-6 bg-slate-800 text-red-400 py-3 rounded-xl font-bold border border-red-500/20">LOGOUT</button>
            </div>

        </main>

        <!-- Bottom Nav -->
        <nav class="h-16 glass fixed bottom-0 w-full flex justify-around items-center rounded-t-2xl z-50">
            <button onclick="nav('home')" id="nav-home" class="flex flex-col items-center text-indigo-400 tab-active w-1/3 h-full justify-center">
                <i class="fas fa-home text-xl mb-1"></i> <span class="text-[10px]">Home</span>
            </button>
            <button onclick="nav('wallet')" id="nav-wallet" class="flex flex-col items-center text-gray-500 w-1/3 h-full justify-center">
                <i class="fas fa-wallet text-xl mb-1"></i> <span class="text-[10px]">Wallet</span>
            </button>
            <button onclick="nav('profile')" id="nav-profile" class="flex flex-col items-center text-gray-500 w-1/3 h-full justify-center">
                <i class="fas fa-user text-xl mb-1"></i> <span class="text-[10px]">Profile</span>
            </button>
        </nav>

        <!-- Join Modal -->
        <div id="modal" class="fixed inset-0 bg-black/90 z-[60] hidden items-center justify-center p-6 backdrop-blur-sm">
            <div class="bg-slate-800 w-full rounded-2xl p-6 border border-slate-700 relative">
                <button onclick="closeModal()" class="absolute top-4 right-4 text-gray-400"><i class="fas fa-times"></i></button>
                <h3 class="text-xl font-bold mb-1">Join Match</h3>
                <p class="text-xs text-gray-400 mb-4">Entry Fee: â‚¹<span id="m-fee" class="text-white"></span></p>
                <input id="m-gname" type="text" placeholder="Enter FreeFire Name" class="w-full bg-slate-900 p-3 rounded-xl mb-4 text-white border border-slate-600 outline-none">
                <button onclick="confirmJoin()" class="w-full bg-indigo-600 py-3 rounded-xl font-bold">CONFIRM & PAY</button>
            </div>
        </div>

    </div>

    <!-- Firebase SDK (Compat for simplicity) -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

    <script>
        // --- CONFIGURATION ---
        const firebaseConfig = {
  apiKey: "AIzaSyBiHHb4uZH_D2dWN2zgIJzjlFeO0fvYvPY",
  authDomain: "ai-brand-supporter.firebaseapp.com",
  databaseURL: "https://ai-brand-supporter-default-rtdb.firebaseio.com",
  projectId: "ai-brand-supporter",
  storageBucket: "ai-brand-supporter.firebasestorage.app",
  messagingSenderId: "257519339474",
  appId: "1:257519339474:web:a99c8b207e02c23b5fea0b"
};
        // NOTE: Use a Vision Model for Images (gpt-oss-120b is text only usually)
        // Using 'google/gemini-2.0-flash-001' via OpenRouter as it's free/cheap and supports Vision.
        const AI_KEY = "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"; 
        const AI_MODEL = "openai/gpt-oss-120b"; 

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.database();
        let user = null;
        let selectedCat = 'all';
        let currentBannerLink = '';

        // --- AUTH ---
        auth.onAuthStateChanged(u => {
            if(u) {
                user = u;
                document.getElementById('auth-screen').classList.add('hidden');
                document.getElementById('app-screen').classList.remove('hidden');
                
                document.getElementById('u-pic').src = u.photoURL || `https://ui-avatars.com/api/?name=${u.email}`;
                document.getElementById('u-name').innerText = u.displayName || u.email.split('@')[0];
                
                db.ref(`users/${u.uid}`).update({ email: u.email, name: u.displayName || 'User' });
                loadData();
            } else {
                document.getElementById('auth-screen').classList.remove('hidden');
                document.getElementById('app-screen').classList.add('hidden');
                auth.getRedirectResult().catch(e => console.error(e));
            }
        });

        function googleLogin() {
            auth.signInWithRedirect(new firebase.auth.GoogleAuthProvider());
        }

        function emailAuth(type) {
            const e = document.getElementById('email').value;
            const p = document.getElementById('password').value;
            const msg = document.getElementById('auth-msg');
            
            if(!e || !p) { msg.innerText = "Fill details"; return; }

            if(type === 'login') {
                auth.signInWithEmailAndPassword(e, p).catch(err => msg.innerText = err.message);
            } else {
                auth.createUserWithEmailAndPassword(e, p).catch(err => msg.innerText = err.message);
            }
        }

        // --- NAVIGATION ---
        function nav(page) {
            document.querySelectorAll('main > div').forEach(d => d.classList.add('hidden'));
            document.getElementById(`page-${page}`).classList.remove('hidden');
            
            // Reset Tabs
            document.querySelectorAll('nav button').forEach(b => {
                b.className = "flex flex-col items-center text-gray-500 w-1/3 h-full justify-center";
            });
            document.getElementById(`nav-${page}`).className = "flex flex-col items-center text-indigo-400 tab-active w-1/3 h-full justify-center";

            if(page === 'profile') loadMyMatches();
        }

        // --- DATA LOADING ---
        function loadData() {
            // Balance Listener
            db.ref(`users/${user.uid}/balance`).on('value', s => {
                const b = s.val() || 0;
                document.getElementById('u-coins').innerText = b;
                document.getElementById('w-bal').innerText = b;
            });

            // Banners
            db.ref('banners').on('value', s => {
                const banners = [];
                s.forEach(c => banners.push(c.val()));
                if(banners.length > 0) {
                    let i = 0;
                    const showBanner = () => {
                        document.getElementById('banner-img').src = banners[i].img;
                        currentBannerLink = banners[i].link; // Store link
                        i = (i+1) % banners.length;
                    };
                    setInterval(showBanner, 4000);
                    showBanner();
                }
            });

            // Categories
            db.ref('categories').on('value', s => {
                const d = document.getElementById('cat-list');
                d.innerHTML = `<div onclick="selectCategory('all', 'All Matches')" class="flex flex-col items-center min-w-[70px] cursor-pointer"><div class="w-14 h-14 rounded-2xl bg-slate-700 flex items-center justify-center border border-gray-600"><i class="fas fa-th text-xl"></i></div><span class="text-[10px] mt-1">All</span></div>`;
                
                s.forEach(c => {
                    const cat = c.val();
                    d.innerHTML += `
                        <div onclick="selectCategory('${c.key}', '${cat.name}')" class="flex flex-col items-center min-w-[70px] cursor-pointer">
                            <img src="${cat.img}" class="w-14 h-14 rounded-2xl object-cover border border-gray-600 p-0.5 bg-slate-800">
                            <span class="text-[10px] mt-1 font-bold text-gray-300">${cat.name}</span>
                        </div>`;
                });
            });

            filterMatch('upcoming');
        }

        function bannerClick() {
            if(currentBannerLink && currentBannerLink.startsWith('http')) {
                window.open(currentBannerLink, '_blank');
            }
        }

        function selectCategory(catId, name) {
            selectedCat = catId;
            document.getElementById('selected-cat-title').innerText = name;
            filterMatch('upcoming'); // Reset to upcoming
        }

        let currentStatus = 'upcoming';
        function filterMatch(status) {
            currentStatus = status;
            // UI Tabs
            ['upcoming','ongoing','ended'].forEach(t => {
                const btn = document.getElementById(`tab-${t}`);
                btn.className = (t === status) ? "px-3 py-1 text-xs font-bold bg-slate-600 rounded text-white" : "px-3 py-1 text-xs font-bold text-gray-400";
            });

            db.ref('tournaments').on('value', s => {
                const list = document.getElementById('t-list');
                list.innerHTML = '';
                
                s.forEach(child => {
                    const t = child.val();
                    const tid = child.key;

                    // Filter logic
                    if(t.status !== status) return;
                    if(selectedCat !== 'all' && t.category !== selectedCat) return;

                    const filled = t.filled || 0;
                    const percent = (filled / t.slots) * 100;

                    let btnHTML = '';
                    if(status === 'upcoming') {
                        if(filled >= t.slots) btnHTML = `<button class="w-full bg-gray-600 py-2 rounded font-bold text-xs cursor-not-allowed">FULL</button>`;
                        else btnHTML = `<button onclick="openJoin('${tid}', ${t.entry})" class="w-full bg-indigo-600 py-2 rounded font-bold text-xs shadow-lg shadow-indigo-500/40">JOIN - â‚¹${t.entry}</button>`;
                    } else if(status === 'ongoing') {
                        btnHTML = `<button onclick="checkRoom('${tid}')" class="w-full bg-emerald-600 py-2 rounded font-bold text-xs animate-pulse">ROOM ID & PASS</button>`;
                    } else {
                        btnHTML = `<div class="text-center text-xs text-yellow-400">Winner: ${t.winner || 'Pending'}</div>`;
                    }

                    list.innerHTML += `
                    <div class="glass p-3 rounded-xl border-l-4 border-indigo-500 relative overflow-hidden">
                        <img src="${t.img || 'https://via.placeholder.com/300x150'}" class="w-full h-28 object-cover rounded-lg mb-2 opacity-80">
                        <h3 class="font-bold text-sm mb-1">${t.title}</h3>
                        <div class="flex justify-between text-[10px] text-gray-400 mb-2">
                            <span>ðŸ“… ${t.date} ${t.time}</span>
                            <span>Map: ${t.map}</span>
                        </div>
                        <div class="flex justify-between bg-slate-900/50 p-2 rounded mb-2">
                            <div class="text-center"><div class="text-[10px] text-gray-500">PRIZE</div><div class="text-xs font-bold text-yellow-400">â‚¹${t.pool}</div></div>
                            <div class="text-center"><div class="text-[10px] text-gray-500">KILL</div><div class="text-xs font-bold">â‚¹${t.perKill}</div></div>
                            <div class="text-center"><div class="text-[10px] text-gray-500">TYPE</div><div class="text-xs font-bold">Solo</div></div>
                        </div>
                        <div class="mb-2">
                             <div class="flex justify-between text-[10px] mb-1"><span>Joined</span><span>${filled}/${t.slots}</span></div>
                             <div class="w-full h-1 bg-slate-700 rounded-full"><div class="h-1 bg-indigo-500 rounded-full" style="width:${percent}%"></div></div>
                        </div>
                        ${btnHTML}
                    </div>`;
                });
                
                if(list.innerHTML === '') list.innerHTML = '<div class="text-center text-gray-500 text-sm mt-10">No matches found.</div>';
            });
        }

        // --- JOIN & ROOM ---
        let joinTid = null;
        let joinFee = 0;
        
        function openJoin(tid, fee) {
            joinTid = tid;
            joinFee = fee;
            document.getElementById('m-fee').innerText = fee;
            document.getElementById('modal').classList.remove('hidden');
            document.getElementById('modal').classList.add('flex');
        }
        function closeModal() {
            document.getElementById('modal').classList.add('hidden');
            document.getElementById('modal').classList.remove('flex');
        }

        function confirmJoin() {
            const name = document.getElementById('m-gname').value;
            const bal = parseInt(document.getElementById('u-coins').innerText);

            if(bal < joinFee) return alert("Low Balance!");
            if(!name) return alert("Enter Game Name");

            const updates = {};
            updates[`users/${user.uid}/balance`] = bal - joinFee;
            updates[`bookings/${joinTid}/${user.uid}`] = { name: name, time: Date.now() };
            updates[`tournaments/${joinTid}/filled`] = firebase.database.ServerValue.increment(1);

            db.ref().update(updates).then(() => {
                alert("Joined Successfully!");
                closeModal();
                nav('profile');
            });
        }

        function checkRoom(tid) {
            db.ref(`bookings/${tid}/${user.uid}`).once('value', s => {
                if(!s.exists()) return alert("You have not joined this match!");
                
                db.ref(`tournaments/${tid}`).once('value', ts => {
                    const t = ts.val();
                    if(t.roomId && t.roomPass) alert(`Room ID: ${t.roomId}\nPass: ${t.roomPass}`);
                    else alert("Wait for Admin to add Room Details.");
                });
            });
        }

        // --- AI WALLET ---
        let payAmt = 0;
        function setAmt(n) {
            payAmt = n;
            document.getElementById('qr-area').classList.remove('hidden');
            document.getElementById('pay-amt').innerText = 'â‚¹' + n;
        }

        async function verifyAI() {
            const file = document.getElementById('ss-input').files[0];
            if(!file || payAmt === 0) return alert("Select Amount & Upload Screenshot");

            const btn = document.getElementById('verify-btn');
            const status = document.getElementById('ai-status');
            
            btn.innerHTML = '<div class="loader mx-auto"></div>';
            status.innerText = "AI Analyzing Screenshot (via OpenRouter)...";

            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = async function() {
                const base64 = reader.result;
                
                try {
                    const response = await fetch("https://openrouter.ai/api/v1/chat/completions", {
                        method: "POST",
                        headers: {
                            "Authorization": `Bearer ${AI_KEY}`,
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify({
                            model: AI_MODEL, 
                            messages: [
                                {
                                    role: "user",
                                    content: [
                                        { type: "text", text: `Analyze this image. Is it a successful payment screenshot of exactly â‚¹${payAmt}? Respond JSON ONLY: {"success": true} or {"success": false}` },
                                        { type: "image_url", image_url: { url: base64 } }
                                    ]
                                }
                            ]
                        })
                    });

                    const data = await response.json();
                    const content = data.choices[0].message.content;
                    
                    if(content.includes("true")) {
                         const cur = parseInt(document.getElementById('u-coins').innerText);
                         await db.ref(`users/${user.uid}/balance`).set(cur + payAmt);
                         alert("Payment Verified! Coins Added.");
                         status.innerText = "Success.";
                         document.getElementById('qr-area').classList.add('hidden');
                    } else {
                        alert("Verification Failed. Invalid Screenshot or Amount.");
                        status.innerText = "Failed.";
                    }

                } catch(e) {
                    console.error(e);
                    alert("AI Error. Try again.");
                }
                btn.innerHTML = 'VERIFY PAYMENT';
            };
        }

        function reqWithdraw() {
            const upi = document.getElementById('w-upi').value;
            const amt = parseInt(document.getElementById('w-amount').value);
            const bal = parseInt(document.getElementById('u-coins').innerText);

            if(amt < 40 || amt > bal) return alert("Invalid Amount");
            
            db.ref('withdrawals').push({ uid: user.uid, amount: amt, upi: upi, status: 'pending' });
            db.ref(`users/${user.uid}/balance`).set(bal - amt);
            alert("Withdraw request sent!");
        }

        function loadMyMatches() {
            // Simple implementation: List all ongoing/upcoming bookings
            // In a real app, you'd index bookings by user ID
            const div = document.getElementById('my-matches');
            div.innerHTML = '<p class="text-xs text-gray-500">History feature requires advanced indexing.</p>';
        }

    </script>
</body>
</html>